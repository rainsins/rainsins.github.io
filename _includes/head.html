<!-- The Head -->

<head>
  {% unless site.theme_mode %}
    {% include mode-toggle.html %}
  {% endunless %}

  {% if page.swiper %}
  <link rel="stylesheet" href="https://{{ site.js_cdn }}/npm/swiper@11/swiper-bundle.min.css" />
  <script src="https://{{ site.js_cdn }}/npm/swiper@11/swiper-bundle.min.js"></script>
  {% endif %}

  {% if page.cube %}

  <script src="https://pan.rainsin.cn:2000/d/blog/js/cube/data-min.js" async></script>

  {% endif %}

  <script src="https://{{ site.js_cdn }}/npm/sweetalert2@11"></script>

  <script>

    let box = document.documentElement;
    if(!box.getAttribute('data-mode')){
      if(modeToggle.modeStatus == 'dark'){
          box.setAttribute('data-mode','dark')
      }else{
          box.setAttribute('data-mode','light')
      }
  }
  </script>



  {% if page.bodymovin %}
  <script src="https://{{ site.cdnjs_cdn }}/ajax/libs/bodymovin/4.10.2/bodymovin.min.js"></script>
  {% endif %}

  {% if page.babel %}
  <script src="https://{{ site.cdnjs_cdn }}/ajax/libs/babel-polyfill/7.12.1/polyfill.min.js"></script>
  <script src="https://{{ site.cdnjs_cdn }}/ajax/libs/babel-standalone/7.24.7/babel.min.js"></script>
  {% endif %}

  {% if page.anime %}
  <script src="https://{{ site.unpkg_cdn3 }}/animejs@3.2.2/lib/anime.min.js"></script>
  {% endif %}

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >


  {% if page.post %}
  <meta name="keywords" content="{{ page.keywords }}">
  <meta name="author" content="{{ page.author }}">
  {% else %}
  <meta name="keywords" content="{{ site.keywords }}">
  <meta name="author" content="{{ site.author }}">
  {% endif %}

  <script>
      window.load_event = {
      ...window.load_event,
      load_anime: ()=>{
        const loads = document.getElementById("loading-gif-box");
        loads.style.opacity = "0";
        loads.style.zIndex = "-999999";
      }
    }
  </script>

  {% if page.math %}
  <!-- MathJax -->
  <script>
    MathJax = {
      tex: {
        inlineMath: [
          ['$', '$'],
          ['\\(', '\\)']
        ],
        displayMath: [
          ['$$', '$$'],
          ['\\[', '\\]']
        ],
        tags: 'ams'
      }
    };
  </script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="{{ site.data.origin[type].mathjax.js | relative_url }}"></script>
{% endif %}

  <!-- <script src="/assets/js/dev.js"></script> -->

  <link rel="stylesheet" href="/assets/css/comments.css"/>
  <link rel="stylesheet" href="/assets/css/root.css"/>

  {% if page.comments %}
  <link
    rel="stylesheet"
    href="https://{{ site.cdnjs_cdn1 }}/ajax/libs/waline/3.3.0/waline.min.css"
  />

  <script src="https://{{ site.cdnjs_cdn1 }}/ajax/libs/waline/3.3.0/waline.umd.min.js"></script>

  <script>
  window.load_event= {
        ...window.load_event,
        comments: () => {
          Waline.init({
              el: '#tcomment',
              serverURL: 'https://waline.rainsin.cn',
              emoji: [
                "//pan.rainsin.cn:2000/d/blog/em/Sticker-100",
                "//pan.rainsin.cn:2000/d/blog/em/bilibili",
                "//pan.rainsin.cn:2000/d/blog/em/Tieba",
                "//pan.rainsin.cn:2000/d/blog/em/alus",
                "//pan.rainsin.cn:2000/d/blog/em/商业头盔",
                "//pan.rainsin.cn:2000/d/blog/em/小人",
                "//pan.rainsin.cn:2000/d/blog/em/小坏坏",
                "//pan.rainsin.cn:2000/d/blog/em/抽象",
                "//pan.rainsin.cn:2000/d/blog/em/搜索引擎",
                "//pan.rainsin.cn:2000/d/blog/em/机场",
                "//pan.rainsin.cn:2000/d/blog/em/猥琐萌",
                "//pan.rainsin.cn:2000/d/blog/em/猫狗",
                "//pan.rainsin.cn:2000/d/blog/em/白白",
                "//pan.rainsin.cn:2000/d/blog/em/突然",
                "//pan.rainsin.cn:2000/d/blog/em/胡桃",
                "//pan.rainsin.cn:2000/d/blog/em/被子",
                "//pan.rainsin.cn:2000/d/blog/em/酷安",
                "//pan.rainsin.cn:2000/d/blog/em/tw",
                "//pan.rainsin.cn:2000/d/blog/em/qq",
                "//pan.rainsin.cn:2000/d/blog/em/weibo"
              ],
              reaction: [
                'https://api.rainsin.cn/2024/07/1720857486493d53f4f18aab45f5c46a716c161670ccd.png',
                'https://api.rainsin.cn/2024/07/17208574864939a772c7206fdda6fd6fafcb8fb63e166.png',
                'https://api.rainsin.cn/2024/07/17208574864933b982af04875523bd86ca76ef8a879df.png',
                'https://api.rainsin.cn/2024/07/17208574864936efb36a4f6d7b16fc3b028d887ef25b8.png',
                'https://api.rainsin.cn/2024/07/1720857486492f900aa3fab03c830f35d6171b313cf1b.png',
                'https://api.rainsin.cn/2024/07/172085748649226e4f8c76fcd7a3f8f705b111319bce9.png',
                'https://api.rainsin.cn/2024/07/17208574864938a3853cfb31b45490464ac06a0dd3533.png',
                'https://api.rainsin.cn/2024/07/172085748649340dcb5b6edb8f423c2350bf460d2eff3.png',
              ],
              pageview: true,
              locale:{
                placeholder: '唠唠嗑（登录不是必需的，评论审核后可见，添加邮箱可在被回复时邮件提醒）',
                reactionTitle: '你是故意找茬是不是啊？',
                reaction0: '正确的',
                reaction1: '错误的',
                reaction2: '小丑的',
                reaction3: '满昏的',
                reaction4: '不错的',
                reaction5: '菜鸡的',
                reaction6: '超逊的',
                reaction7: '发烧的',
                admin: '站长',
                level0: '素人',
                level1: '企划',
                level2: '企划专属',
                level3: '专属',
                level4: '双专属',
                level5: '三社共有',
                nick: '名称',
                sofa: '来一起击剑🤺吧'
              },
              dark: 'html[data-mode="dark"]',
              imageUploader: false,
              search: false
          });
        }
      }
</script>

<style>
  .wl-emoji-popup .wl-tab-wrapper button{
    width: 4em;
  }
  .wl-emoji-popup .wl-tab-wrapper button img{
    max-height: 3.5em;
    max-width: 3.5em;
  }
</style>
  {% endif %}

  <script>
    const style = document.createElement("style");
    style.type = "text/css";

    if(modeToggle.modeStatus == "dark"){
      style.innerHTML="#loading-gif-box{background-color: #000;} .loading-boxs-imgs{background-image: url(https://pan.rainsin.cn:2000/d/blog/img/darkload.gif?sign=HSMBFJIuwRnWabf8E1WJKYaTOneSVDmMdmfOphPDbdw=:0);}"
    }else{
      style.innerHTML="#loading-gif-box{background-color: #fff;} .loading-boxs-imgs{background-image: url(https://pan.rainsin.cn:2000/d/blog/img/loadlight.gif?sign=FJgpddP5fi4a60y3yWNyJ6chvzOREupwOfPWk03U_ik=:0);}"
    };

    document.getElementsByTagName("head")[0].appendChild(style);
  </script>

  {% if page.react %}
    <script src="https://{{ site.unpkg_cdn1 }}/react@18.3.1/umd/react.production.min.js"></script>
    <script src="https://{{ site.unpkg_cdn1 }}/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
    <script src="/assets/js/swr.min.js" async></script>
  {% endif %}

  {% if page.video %}
  <script src="https://{{ site.unpkg_cdn3 }}/artplayer@5.1.6/dist/artplayer.js"></script>
  <script src="https://{{ site.unpkg_cdn3 }}/artplayer-plugin-danmuku@5.1.4/dist/artplayer-plugin-danmuku.legacy.js"></script>
  {% endif %}

  {% if page.music %}
    <link rel="stylesheet" href="https://{{ site.unpkg_cdn2 }}/aplayer@1.10.1/dist/APlayer.min.css">
    <script src="https://{{ site.unpkg_cdn2 }}/aplayer@1.10.1/dist/APlayer.min.js"></script>
    <script src="https://{{ site.unpkg_cdn2 }}/meting@2.0.1/dist/Meting.min.js"></script>
  {% endif %}

  {% if page.jquery %}
    <script src="https://{{ site.unpkg_cdn3 }}/jquery@3.7.1/dist/jquery.min.js"></script>
  {% endif %}

  {% if page.chart %}
    <script src="https://{{ site.unpkg_cdn3 }}/chart.js@4.4.3/dist/chart.umd.js"></script>
  {% endif %}

  {% if page.mathpolt %}
    <script src="https://{{ site.cdnjs_cdn }}/ajax/libs/d3/7.9.0/d3.min.js"></script>
    <script src="https://{{ site.unpkg_cdn3 }}/function-plot@1.25.0/dist/function-plot.js"></script>
  {% endif %}

  {% if page.cube %}
  <script src="/assets/post/cube/dist/705.js"></script>
  <script src="/assets/post/cube/dist/781.js"></script>
  <script src="/assets/post/cube/dist/795.js"></script>
  <script src="/assets/post/cube/dist/576.js"></script>
  <script src="/assets/post/cube/dist/661.js"></script>
  <script src="/assets/post/cube/dist/200.js"></script>
  <script src="/assets/post/cube/dist/134.js"></script>

   <script src="/assets/post/cube/dist/main.js"></script>

  {% endif %}

  {% if page.require %}
  <script src="https://{{ site.unpkg_cdn3 }}/requirejs@2.3.6/require.min.js"></script>
  {% endif %}

  {% if page.linksdata %}
  <script src="/assets/links/linksdata.js"></script>
  {% endif %}

  {% if page.animatecss %}
  <link rel="stylesheet" href="https://{{ site.unpkg_cdn }}/animate.css@4.1.1/animate.min.css">
  {% endif %}

  {% capture seo_tags %}
    {% seo title=false %}
  {% endcapture %}

  {% if page.image %}
    {% assign img = page.image.path | default: page.image %}

    {% unless img contains '://' %}
      {% assign img_path = page.img_path | append: '/' | append: img | replace: '//', '/' %}
      {% capture target %}"{{ img | absolute_url }}"{% endcapture %}

      {% if site.img_cdn contains '//' %}
        <!-- it's a cross-origin URL -->
        {% capture replacement %}"{{ site.img_cdn }}{{ img_path }}"{% endcapture %}
      {% else %}
        <!-- it's a local file path -->
        {%- capture replacement -%}
          "{{ site.img_cdn | append: '/' | append: img_path | replace: '//', '/' | absolute_url }}"
        {%- endcapture -%}
      {% endif %}

      {% assign seo_tags = seo_tags | replace: target, replacement %}
    {% endunless %}
  {% endif %}

  {{ seo_tags }}

  <title>
    {%- unless page.layout == 'home' -%}
      {{ page.title | append: ' | ' }}
    {%- endunless -%}
    {{ site.title }}
  </title>

  {% include favicons.html %}

  {% if site.resources.ignore_env != jekyll.environment and site.resources.self_hosted %}
    <link href="{{ site.data.origin[type].webfonts | relative_url }}" rel="stylesheet">

  {% else %}
    {% for cdn in site.data.origin[type].cdns %}
      <link rel="preconnect" href="{{ cdn.url }}" {{ cdn.args }}>
      <link rel="dns-prefetch" href="{{ cdn.url }}" {{ cdn.args }}>
    {% endfor %}

    <link rel="stylesheet" href="{{ site.data.origin[type].webfonts | relative_url }}">
  {% endif %}

  <!-- GA -->
  {% if jekyll.environment == 'production' and site.google_analytics.id != empty and site.google_analytics.id %}
    <link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">

    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
  {% endif %}

  <!-- Bootstrap -->
  <link rel="stylesheet" href="{{ site.data.origin[type].bootstrap.css | relative_url}}">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="{{ site.data.origin[type].fontawesome.css | relative_url }}">

  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">

  {% if site.toc and page.toc %}
    <link rel="stylesheet" href="{{ site.data.origin[type].toc.css | relative_url }}">
  {% endif %}

  {% if page.layout == 'page' or page.layout == 'post' %}
    <!-- Manific Popup -->
    <link rel="stylesheet" href="{{ site.data.origin[type].magnific-popup.css | relative_url }}">
  {% endif %}

  <!-- 流量分析 -->
  <script defer data-website-id="202ceef1-7698-45d5-a10e-fc97f6a046c0">
    !function(){"use strict";(t=>{const{screen:{width:e,height:a},navigator:{language:r},location:n,localStorage:i,document:c,history:o}=t,{hostname:s,href:u}=n,{currentScript:l,referrer:d}=c;if(!l)return;const m="data-",f=l.getAttribute.bind(l),h=f(m+"website-id"),p=f(m+"host-url"),g=f(m+"tag"),y="false"!==f(m+"auto-track"),b="true"===f(m+"exclude-search"),v=f(m+"domains")||"",w=v.split(",").map((t=>t.trim())),S=`${(p||"https://api-gateway.umami.dev"||l.src.split("/").slice(0,-1).join("/")).replace(/\/$/,"")}/api/send`,N=`${e}x${a}`,T=/data-umami-event-([\w-_]+)/,A=m+"umami-event",x=300,O=t=>{if(t){try{const e=decodeURI(t);if(e!==t)return e}catch{return t}return encodeURI(t)}},U=t=>{try{const{pathname:e,search:a}=new URL(t);t=e+a}catch{}return b?t.split("?")[0]:t},j=()=>({website:h,hostname:s,screen:N,language:r,title:O(_),url:O(B),referrer:O(D),tag:g||void 0}),k=(t,e,a)=>{a&&(D=B,B=U(a.toString()),B!==D&&setTimeout($,x))},E=()=>!h||i&&i.getItem("umami.disabled")||v&&!w.includes(s),L=async(t,e="event")=>{if(E())return;const a={"Content-Type":"application/json"};void 0!==K&&(a["x-umami-cache"]=K);try{const r=await fetch(S,{method:"POST",body:JSON.stringify({type:e,payload:t}),headers:a}),n=await r.text();return K=n}catch{}},$=(t,e)=>L("string"==typeof t?{...j(),name:t,data:"object"==typeof e?e:void 0}:"object"==typeof t?t:"function"==typeof t?t(j()):j()),I=t=>L({...j(),data:t},"identify");t.umami||(t.umami={track:$,identify:I});let K,R,B=U(u),D=d!==s?d:"",_=c.title;if(y&&!E()){(()=>{const t=(t,e,a)=>{const r=t[e];return(...e)=>(a.apply(null,e),r.apply(t,e))};o.pushState=t(o,"pushState",k),o.replaceState=t(o,"replaceState",k)})(),(()=>{const t=new MutationObserver((([t])=>{_=t&&t.target?t.target.text:void 0})),e=c.querySelector("head > title");e&&t.observe(e,{subtree:!0,characterData:!0,childList:!0})})(),c.addEventListener("click",(async t=>{const e=t=>["BUTTON","A"].includes(t),a=async t=>{const e=t.getAttribute.bind(t),a=e(A);if(a){const r={};return t.getAttributeNames().forEach((t=>{const a=t.match(T);a&&(r[a[1]]=e(t))})),$(a,r)}},r=t.target,i=e(r.tagName)?r:((t,a)=>{let r=t;for(let t=0;t<a;t++){if(e(r.tagName))return r;if(r=r.parentElement,!r)return null}})(r,10);if(!i)return a(r);{const{href:e,target:r}=i,c=i.getAttribute(A);if(c)if("A"===i.tagName){const o="_blank"===r||t.ctrlKey||t.shiftKey||t.metaKey||t.button&&1===t.button;if(c&&e)return o||t.preventDefault(),a(i).then((()=>{o||(n.href=e)}))}else if("BUTTON"===i.tagName)return a(i)}}),!0);const t=()=>{"complete"!==c.readyState||R||($(),R=!0)};c.addEventListener("readystatechange",t,!0),t()}})(window)}();
  </script>

  <link href="/assets/css/font.css" rel="stylesheet">
 <script defer>
  function testIPv6Support() {
  return new Promise(function(resolve, reject) {
  let ipv6Url = 'https://api6.ipify.org?format=json';

  let xhr = new XMLHttpRequest();
  xhr.open('GET', ipv6Url, true);
  xhr.onload = function() {
  if (xhr.status === 200) {
  try {
  let response = JSON.parse(xhr.responseText);
  let ipAddress = response.ip;
  if (isIPv6Address(ipAddress)) {
  resolve(true);
  } else {
  resolve(false);
  }
  } catch (error) {
  resolve(false);
  }
  } else {
  resolve(false);
  }
  };
  xhr.onerror = function() {
  resolve(false);
  };
  xhr.send();
  });
  }

  function isIPv6Address(ipAddress) {
  // 检查IP地址是否为IPv6格式
  let regex = /^([0-9a-fA-F]{0,4}:){1,7}[0-9a-fA-F]{0,4}$/;
  return regex.test(ipAddress);
  }
  // 使用示例
  testIPv6Support().then(function(supported) {
  if (supported) {
  ipv6Flag = true;
  } else {
    Swal.fire({
      title: "当前网络好像不支持IPv6?",
      text: "可能是你的网络没开启，或者浏览器的原因，亦或者脚本判断有问题。\n如果网络不支持IPv6，这个网站中的一部分内容可能无法访问。",
      icon: "question"
    });
  }
  });
 </script>
  {% include set-mode.html %}
  {% include metadata-hook.html %}
</head>

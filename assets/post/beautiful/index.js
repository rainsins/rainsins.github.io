function Mer() {
    return (
        <>
            <img src="https://api.rainsin.cn/2024/07/f6191a5cc56324631df995133cf1a58e.jpg" />
            <img src="https://api.rainsin.cn/2024/07/d8e42825aaf4cfd5b3ae39fff87209e3.jpg" />
            <img src="https://api.rainsin.cn/2024/07/440ee742ed9792a7ded157c2c3ea3d29.jpg" />
            <img src="https://api.rainsin.cn/2024/07/4f544eca47b4b4b0b055172a0f42e953.jpg" />
            <img src="https://api.rainsin.cn/2024/07/d1da05f918eadbc4604f7a84ad25ee80.webp" />
            <img src="https://api.rainsin.cn/2024/07/83c8933a5a60cf8d9d23759685f1a16d.webp" />
            <img src="https://api.rainsin.cn/2024/07/7745c8c0d62df8aa227963e9044ccf79.webp" />
            <img src="https://api.rainsin.cn/2024/07/af7d626c0928bb2ecc004be4c2ca482b.webp" />
            <img src="https://api.rainsin.cn/2024/07/37226586ed385b33822186785b3d89a3.webp" />
            <img src="https://api.rainsin.cn/2024/07/d07e06b7d93c432acd947adede58c167.webp" />
            <img src="https://api.rainsin.cn/2024/07/41bbbfa862d6565e5b5fe1c165727902.webp" />
            <img src="https://api.rainsin.cn/2024/07/a71baa6548011c146918e55a5a0747fa.webp" />
            <img src="https://api.rainsin.cn/2024/07/6776f9689600e5aa604b2f884c1985b8.webp" />
            <img src="https://api.rainsin.cn/2024/07/f4e45972f47f504d2e234e702f5ba3a6.webp" />
            <img src="https://api.rainsin.cn/2024/07/7f1dd13203b3fb10f42775a364dd6898.webp" />
            <img src="https://api.rainsin.cn/2024/07/0aed64fd3e6af411adb2e6c7969a8fbd.webp" />
            <img src="https://api.rainsin.cn/2024/07/75f6fb16a8c5c697b2060ff3f2a36d1b.webp" />
            <img src="https://api.rainsin.cn/2024/07/b2ca9a71e066bcf47a9787755d4f03ba.webp" />
            <img src="https://api.rainsin.cn/2024/07/77001026f0a56af1fc3c7f4a7ab3c3da.webp" />
            <img src="https://api.rainsin.cn/2024/07/7cc968fe95f06e2a1b57fda79199f2fc.webp" />
            <img src="https://api.rainsin.cn/2024/07/e7ef4631d7472fb0f637cf5a51e71e22.webp" />
            <img src="https://api.rainsin.cn/2024/07/2dd7b121d43c40b520ef5f6e6c64b383.webp" />
            <img src="https://api.rainsin.cn/2024/07/400a84b48d8e2656ee704ad253f57c75.webp" />
            <img src="https://api.rainsin.cn/2024/07/e7b9b6f6897e75abfec9143358faec55.webp" />
            <img src="https://api.rainsin.cn/2024/07/8d374721373cf232d5dec77b9859d6f2.webp" />
            <img src="https://api.rainsin.cn/2024/07/5134399e54ea59270dbb65cbd9cde176.webp" />
            <img src="https://api.rainsin.cn/2024/07/288ccf6fbfc190db73f5110b98054faf.webp" />
            <img src="https://api.rainsin.cn/2024/07/764336f84545d4bf54659f9486f9d4dd.webp" />
            <img src="https://api.rainsin.cn/2024/07/0cf61856331c9543f41a4869c97a2bfc.webp" />
            <img src="https://api.rainsin.cn/2024/07/49cdca2ca008150888fa21bb3ee2a672.webp" />
            <img src="https://api.rainsin.cn/2024/07/e003236c8e1f76e44282c3805d6cf5fc.webp" />
            <img src="https://api.rainsin.cn/2024/07/456f956975b3f7644a5a99e0311793c3.webp" />
            <img src="https://api.rainsin.cn/2024/07/47a5ba3e6659edb9bc85af6941bd01c4.webp" />
            <img src="https://api.rainsin.cn/2024/07/bc6451450cf90312b5db9514d419ef84.webp" />
            <img src="https://api.rainsin.cn/2024/07/0212b778201a711ea4d44b6f7018dc38.webp" />
            <img src="https://api.rainsin.cn/2024/07/17ba5b91fab06bdc6ccc44247bea4f74.webp" />
            <img src="https://api.rainsin.cn/2024/07/17e7d5a2584b10f9c5e068bdce02d018.webp" />
            <img src="https://api.rainsin.cn/2024/07/c73a4c99264cd08652ccab349a4223fd.webp" />
            <img src="https://api.rainsin.cn/2024/07/d6ac30bb3bc20963a5de047956b32f44.webp" />
            <img src="https://api.rainsin.cn/2024/07/5853a1117c07cf07151216addc93eb17.webp" />
            <img src="https://api.rainsin.cn/2024/07/1eb74a2cda04ebb23e607eabdcfd1854.webp" />
            <img src="https://api.rainsin.cn/2024/07/42f46016cabbe6fb47e25e601cfa9d66.webp" />
            <img src="https://api.rainsin.cn/2024/07/8f100ed484f9da89c482c9f94e6991a6.webp" />
            <img src="https://api.rainsin.cn/2024/07/d17c321082f4c98f45ab22ac4e0a3f7b.webp" />
            <img src="https://api.rainsin.cn/2024/07/2a11888701b208afdcb9e27c27e701d4.webp" />
            <img src="https://api.rainsin.cn/2024/07/f7b4c607bd3ba629f07a2c80f52776a2.webp" />
            <img src="https://api.rainsin.cn/2024/07/0075137ede8bcd1fbd445d1ac638f7c6.webp" />
            <img src="https://api.rainsin.cn/2024/07/0491d90d92160a5548aaa5515281a08a.webp" />
            <img src="https://api.rainsin.cn/2024/07/b8871e90832e778837f106b4e6b2bfbc.webp" />
            <img src="https://api.rainsin.cn/2024/07/4ba32636f99a2ba676690cc9aea64dcb.webp" />
            <img src="https://api.rainsin.cn/2024/07/c38b6083265ad6e9a51130a02b053b95.webp" />
            <img src="https://api.rainsin.cn/2024/07/e58c4fb40f9b952f87ec9e05932ccb26.webp" />
            <img src="https://api.rainsin.cn/2024/07/594a4734aa2f206abb7c0bcb6dc39329.webp" />
            <img src="https://api.rainsin.cn/2024/07/6a688ba4661dc61d2e0309874a9a83e7.webp" />
            <img src="https://api.rainsin.cn/2024/07/e586c6140e20daa648a7249829732ffc.webp" />
            <img src="https://api.rainsin.cn/2024/07/35a69a3d7add8971e99f6ca65a7a2687.webp" />
            <img src="https://api.rainsin.cn/2024/07/10a2ddb82cbd6384388c0ce41a82bc79.webp" />
            <img src="https://api.rainsin.cn/2024/07/17e7d5a2584b10f9c5e068bdce02d018.webp" />
            <img src="https://api.rainsin.cn/2024/07/199ef9611b6d3442ac3fa9a1d488dede.webp" />
            <img src="https://api.rainsin.cn/2024/07/f4b70e8a86c30fc18ebc0cbbf28917be.webp" />
            <img src="https://api.rainsin.cn/2024/07/ed319398ba06c46508db1943ee2df16f.webp" />
            <img src="https://api.rainsin.cn/2024/07/e6dffa519e2ec0c900fc0239678c5f8f.webp" />
            <img src="https://api.rainsin.cn/2024/07/62ff25acc0f637c97ccf2398d73f6004.webp" />
            <img src="https://api.rainsin.cn/2024/07/bd848c4bc735bcd5bbdd8ec2d0922fe5.webp" />
            <img src="https://api.rainsin.cn/2024/07/f09dadb9680cdb16ebb2d4475e1de9de.webp" />
            <img src="https://api.rainsin.cn/2024/07/d886b4ac0ac458ff5fc2f33f9569f669.webp" />
            <img src="https://api.rainsin.cn/2024/07/48fc5773f8c53e9b898ef681574ec19f.webp" />
            <img src="https://api.rainsin.cn/2024/07/788a20041cefaf55587cb8eda9e58c7b.webp" />
            <img src="https://api.rainsin.cn/2024/07/27b8759111c30ed4c31ac9d9823c98c7.webp" />
            <img src="https://api.rainsin.cn/2024/07/bf61a1fcaebd2f0c872437972fa8d7f6.webp" />
        </>
    );
};

//是否展示
const okContext = React.createContext(false);
//答案是否对
const AnsContext = React.createContext(false);

const questions = [
    {
        latex: "\\lim_{x\\rightarrow 0} \\frac{\\left( 1+x\\right)^{\\frac{1}{x} }  -\\left( 1+2x\\right)^{\\frac{1}{2x} }  }{sinx} ",
        ans: "\\frac{e}{2}",
        ans1: "\\frac{1}{2}e"
    },
];

const key_latex = [
    {
        latex: "\\frac{}{}",
        add: 7,
        exp: "\\frac{a}{b}",
        title: "分式"
    },
    {
        latex: "\\sqrt[]{}",
        add: 7,
        exp: "\\sqrt[a]{b}",
        title: "开b的a次方根"
    },
    {
        latex: "\\sqrt{}",
        add: 7,
        exp: "\\sqrt{a}",
        title: "开a的平方"
    },
    {
        latex: "{}^{}_{}",
        add: 2,
        exp: "{s}^{a}_{b}",
        title: "上下标"
    },
    {
        latex: "{}_{}",
        add: 2,
        exp: "{s}_{a}",
        title: "下标"
    },
    {
        latex: "{}^{}",
        add: 2,
        exp: "{s}^{a}",
        title: "上标"
    },
    {
        latex: "||",
        add: 2,
        exp: "|a|",
        title: "绝对值"
    },
    {
        latex: "\\infty",
        add: 1,
        exp: "\\infty",
        title: "无穷"
    },
];

function Question({ lat }) {
    const [isOk, setIsOk] = React.useContext(okContext);
    const [isAns, setAns] = React.useContext(AnsContext);

    const [latexData, setLatexData] = React.useState("");

    React.useEffect(() => {
        let math = document.getElementsByClassName("ques-detail");
        MathJax.typeset(math);
        let math2 = document.getElementsByClassName("key-item");
        MathJax.typeset(math2);
    }, []);

    let isRun = false;

    React.useEffect(() => {
        let math3 = document.getElementsByClassName("show-ans-latex");
        MathJax.typeset(math3);
        if (latexData == lat.ans || latexData == lat.ans1) {
            setAns(true);
        }
    }, [latexData]);

    const add_text = (el, ev) => {
        let tem = `${latexData}${el.exp}`;
        setLatexData(tem);
        document.getElementById("in-latex").value = tem;
    };

    const data_change = (e) => {
        setLatexData(e.target.value);
    };

    const key_item = key_latex.map((el, index) => {
        return (
            <div className="key-item" key={index} title={el.title} onClick={(event) => add_text(el, event)}>
                <div className="key-item-on">{`\\(${el.exp}\\)`}</div>
            </div>
        );
    });

    function isOk_handle() {
        if (isAns) {
            setIsOk(true);
        } else {
            alert("答案错误，请重新输入！")
        }
    };

    return (
        <div className="ques-main">
            <div className="ques-box">
                <div className="ques-title">
                    问题：
                </div>
                <div className="ques-detail">
                    $${lat.latex}$$
                </div>
            </div>
            <div className="ans-box">
                <div className="ans-title">
                    答案：
                </div>
                <div className="latex-keyborad">
                    <div className="key-title">小键盘</div>
                    <div className="latex-keyborad-det">
                        {key_item}
                    </div>
                </div>
                <div className="ans-show-box">
                    <input id="in-latex" className="ans-show-in" min="1" max="20" placeholder="请输入你的答案（Latex）" onChange={data_change} />
                    <div className="ans-show">
                        <div className="show-ans-latex">
                            {`$$${latexData}$$`}
                        </div>
                    </div>
                </div>
                <div className="botton-ques-box">
                    <div className="botton-ques" onClick={isOk_handle}>
                        提交答案
                    </div>
                </div>
            </div>
        </div>
    );
};

function MathCom() {
    // const [isOk,setIsOk] = React.useContext(okContext);
    // const [isAns,setAns] = React.useContext(AnsContext);

    const q_item = questions.map((el, index) => {
        return (
            <Question lat={el} />
        );
    });

    React.useEffect(() => {
        let math = document.getElementsByClassName("show-tip-latex");
        MathJax.typeset(math);
    }, []);

    return (
        <div className="question-boxs">
            {q_item}
            <h4 id='提示'>提示</h4>
            <p>
            分子变形：
            </p>
            <div className="show-tip-latex">
            {`$$ \\left( 1+x\\right)^{\\frac{1}{x} }  -\\left( 1+2x\\right)^{\\frac{1}{2x} }  =e^{\\frac{ln\\left( 1+x\\right)  }{x} }-e^{\\frac{ln\\left( 1+2x\\right)  }{2x} }  $$`}
            </div>
            <p>
            对分子进行泰勒展开，写成无穷级数形式：
            </p>
            <p>
            由以下常用的展开式：
            </p>
            <div className="show-tip-latex">
            {`$$ ln\\left( 1+x\\right)  =x-\\frac{1}{2} x^{2}+\\frac{1}{3} x^{3}\\  \\cdots  $$`}
            </div>
            <p>
            我们可以有
            </p>
            <div className="show-tip-latex">
            {`$$ \\frac{ln\\left( 1+x\\right)  }{x} =1-\\frac{1}{2} x+\\frac{1}{3} x^{2}-\\  \\cdots  $$`}
            </div>
            <p>
            故我们可以得到分子指数部分的展开
            </p>
            <div className="show-tip-latex">
            {`$$ e^{\\frac{ln\\left( 1+x\\right)  }{x} }=e^{\\left[ 1-\\frac{1}{2} x+\\frac{1}{3} x^{2}-\\  \\cdots \\right]  }=e\\  e^{\\left[ -\\frac{1}{2} x+\\frac{1}{3} x^{2}-\\  \\cdots \\right]  } $$`}
            </div>
            <p>
            又由另外一个常用的展开式：
            </p>
            <div className="show-tip-latex">
            {`$$ e^{x}=1+x+\\frac{1}{2} x^{2}+\\frac{1}{6} x^{3}+\\  \\cdots  $$`}
            </div>
            <p>
            所以有
            </p>
            <div className="show-tip-latex">
            {`$$ e\\  e^{\\left[ -\\frac{1}{2} x+\\frac{1}{3} x^{2}-\\  \\cdots \\right]  }=e\\left[ 1-\\frac{1}{2} x+\\underbrace{\\frac{1}{3} x^{2}\\  \\cdots +\\frac{1}{2} \\left( -\\frac{1}{2} x+\\frac{1}{3} x^{2}\\  \\cdots \\right)^{2}  +\\cdots }_{\\text{次数高于1次} } \\right]   $$`}
            </div>
            <p>
            此题我们只需到<strong>一次</strong>就行了，如上，我们将次数高于1次的合并有
            </p>
            <div className="show-tip-latex">
            {`$$ \\left( 1+x\\right)^{\\frac{1}{x} }  =e\\left[ 1-\\frac{1}{2} x+o\\left( x\\right)  \\right]  =e-\\frac{1}{2} ex+o\\left( x\\right)  $$`}
            </div>
            <p>
            于是我们得到了一个无穷小等价
            </p>
            <div className="show-tip-latex">
            {`$$ \\left( 1+x\\right)^{\\frac{1}{x} }  -e\\  \\sim \\  -\\frac{1}{2} ex $$`}
            </div>
            <p>
            应用到此题中 
            </p>
            <div className="show-tip-latex">
            {`$$ \\lim_{x\\rightarrow 0} \\frac{\\left( 1+x\\right)^{\\frac{1}{x} }  -\\left( 1+2x\\right)^{\\frac{1}{2x} }  }{sin\\  x} =\\lim_{x\\rightarrow 0} \\frac{\\left( 1+x\\right)^{\\frac{1}{x} }  -e-[\\left( 1+2x\\right)^{\\frac{1}{2x} }  -e]}{sin\\  x} =\\lim_{x\\rightarrow 0} \\frac{-\\frac{1}{2} ex+ex}{sin\\  x} =\\lim_{x\\rightarrow 0} \\frac{\\frac{1}{2} ex}{sin\\  x} $$`}
            </div>
            <p>
            由重要极限
            </p>
            <div className="show-tip-latex">
            {`$$ \\lim_{x\\rightarrow 0} \\frac{sin\\  x}{x} \\  =\\  1 $$`}
            </div>
            <p>
            这样就可以得出答案了。上面的无穷小等价在求极限时很有用，如果你要考研的话可以记一记。
            </p>
        </div>
    );
};

function Is_Show({ isok, setok }) {
    const [isOk, setIsOk] = React.useState(false);
    const [isAns, setAns] = React.useState(false);
    return (
        <div className="is-show-mm">
            <AnsContext.Provider value={[isAns, setAns]}>
                <okContext.Provider value={[isOk, setIsOk]}>
                    {isOk ? <Mer /> : <MathCom />}
                </okContext.Provider>
            </AnsContext.Provider>
        </div>
    );
};

const mm_boxs = ReactDOM.createRoot(document.getElementById('mm-box'));
mm_boxs.render(<Is_Show />);